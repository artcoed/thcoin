# Диагностика проблем с Telegram WebApp

## Проблема: "failed get user data" на странице регистрации

### Возможные причины:

1. **Приложение не запущено в Telegram WebApp**
   - Убедитесь, что приложение открыто через бота в Telegram
   - Проверьте, что используется правильная ссылка на WebApp

2. **Данные пользователя недоступны**
   - Пользователь не авторизован в Telegram
   - Проблемы с правами доступа к данным пользователя

3. **Проблемы с инициализацией WebApp**
   - Скрипт Telegram WebApp не загружен
   - Ошибки в консоли браузера

### Как диагностировать:

1. **Откройте консоль браузера** (F12)
2. **Проверьте отладочную информацию** на странице регистрации (в development режиме)
3. **Посмотрите логи в консоли**:
   - `Is Telegram WebApp: true/false`
   - `Telegram user data: {...}`
   - `Telegram ID: ...`

### Что проверить:

1. **В консоли браузера:**
   ```javascript
   // Проверьте, доступен ли объект Telegram
   console.log('window.Telegram:', window.Telegram);
   
   // Проверьте данные пользователя
   console.log('User data:', window.Telegram?.WebApp?.initDataUnsafe?.user);
   
   // Проверьте initData
   console.log('InitData:', window.Telegram?.WebApp?.initData);
   ```

2. **В отладочной панели на странице:**
   - Is Telegram WebApp: должно быть `true`
   - Has User: должно быть `true`
   - User Data: должен содержать объект с данными пользователя

### Решения:

1. **Если Is Telegram WebApp: false**
   - Убедитесь, что приложение открыто через бота
   - Проверьте URL приложения

2. **Если Has User: false**
   - Пользователь должен быть авторизован в Telegram
   - Попробуйте перезапустить приложение

3. **Если данные пользователя есть, но ID отсутствует**
   - Проверьте структуру данных пользователя
   - Убедитесь, что поле `id` присутствует

### Тестирование:

Для тестирования в браузере (не в Telegram):
1. Откройте консоль браузера
2. Выполните:
   ```javascript
   // Симуляция Telegram WebApp
   window.Telegram = {
     WebApp: {
       initData: 'test',
       initDataUnsafe: {
         user: {
           id: 123456789,
           first_name: 'Test',
           username: 'testuser'
         }
       }
     }
   };
   ```

### Логи для отладки:

Все важные события логируются в консоль:
- Инициализация WebApp
- Получение данных пользователя
- Ошибки при получении данных
- Результаты API запросов 